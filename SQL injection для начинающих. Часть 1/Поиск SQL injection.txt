Как Вы уже поняли, инъекция появляется из входящих данных, которые не фильтруются. Самая распространенная ошибка — это не фильтрация передаваемого ID. Ну грубо говоря подставлять во все поля кавычки. Будь это GET/POST запрос и даже Cookie!



Числовой входящий параметр

Для практики нам понадобится скрипт index1.php. Как я уже говорил выше, подставляем кавычки в ID новости.

sqlinj/index1.php?id=1'


Т.к. у нас запрос не имеет фильтрации:

$id = $_GET['id'];
$query = "SELECT * FROM news WHERE id=$id";


Скрипт поймет это как
SELECT * FROM news WHERE id=1'


И выдаст нам ошибку:
Warning: mysql_fetch_array() expects parameter 1 to be resource, boolean given in C:\WebServ\domains\sqlinj\index1.php on line 16

Если ошибку не выдало — могут быть следующие причины:

1.SQL инъекции здесь нет — Фильтруются кавычки, или просто стоит преобразование в (int)
2.Отключен вывод ошибок.

Если все же ошибку вывело — Ура! Мы нашли первый вид SQL инъекции — Числовой входящий параметр.


Строковой входящий параметр


Запросы будем посылать на index2.php. В данном файле, запрос имеет вид:
$user = $_GET['user'];
$query = "SELECT * FROM news WHERE user='$user'";


Тут мы делаем выборку новости по имени пользователя, и опять же — не фильтруем.
Опять посылаем запрос с кавычкой:
sqlinj/index2.php?user=AlexanderPHP'


Выдало ошибку. Ок! Значит уязвимость есть. Для начала нам хватит — приступим к практике.